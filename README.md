ngAudioSprite
===================

The angular audio sprite has been designed around the format output used by the [audiosprite](https://github.com/tonistiigi/audiosprite) which generates audio sprites in multiple formats
as well as a JSON map of the sounds.

## Usage

### Configuration object

This is the format generated by `audiosprite` and supported by `ngAudioSprite`.
When loading a config file a base path will be generated based on the configuration file path which will be prefixed to the resource use.

```json
{
  "resources": [
    "sprite.ogg", 
    "sprite.m4a",
    "sprite.mp3",
    "sprite.ac3"
  ],
  "spritemap": {
    "sound1": {
      "start": 0,
      "end": 1.92,
      "loop": false
    },
    "sound2": {
      "start": 3,
      "end": 4.824013605442177,
      "loop": false
    }
}
```

### Loading a configuration file

From the service `audioSprite.load("sprite.json");`

or

From the directive `<audio ng-audio-sprite="sprite.json"></audio>`. Updating the directive attribute when used will trigger loading

### Setting the configuration

Respect the same format as the configuration object but set the paths for resources as no request path will be available to generate them.

From the service `audioSprite.configure(config);`

### Playing a sound

To play a sound from the audio sprite simply call `play` on the service and pass it the sound key as found on the `spritemap` of the configuration object.

`audioSprite.play("sound1");`

### Stopping a sound

Simply call `stop` on the service

`audioSprite.stop();`

### Pausing a sound

Simply call `pause` on the service

`audioSprite.pause();`

### Muting a sound

Simply call `mute` on the service

`audioSprite.mute();` `audioSprite.unmute();`

### Setting the volume

Simply call `volume` on the service (max = 1)

`audioSprite.volume(0.5);`

### Doing more from the directive

You can also still set yourself the sources for the audio and simply pass the sprite map via the `ng-audio-spritemap` attribute.
Attribute update will update the sprite map used.

```html

<audio ng-audio-sprite ng-audio-spritemap='{"sound1": { "start": 0, "end": 1.92, "loop": false }, "sound2": { "start": 3, "end": 4.824013605442177, "loop": false}}'>
    <source src="sprite.ogg" type="audio/ogg" />
</audio>

```

### Listening to property changes

The service as an `observe` method which allows other object to listen to property change.
`$watch` wasn't working well and I wanted to avoid using `$on` and `$broadcast`.

Make sure to call the `destroy` method when the `$destroy` event is fired on the scope.


```js

/**
 * @param id {String} Property to observe
 * @param callback {Function} Callback function
 * @param [scope] {Object} Scope for the callback function
 */
audioSprite.observe("id", function(newIdValue) {
    // do stuff
}, this);

```

## Running the demo

To run the demo simply clone this repo, install dependencies and run the web server. The demo will be available at `http://localhost:8000/app/`
 
```npm install``` to install dependencies

```npm start``` to start the web server

## Dev commands

```npm test``` to start unit testing suite (test run when app file is updated)

```npm run protractor``` to start end to end testing, the web server must be running and WebDriver installed using ```npm run update-webdriver```

```grunt``` to build the application from the source directory

```grunt watch``` to build the application when files are updated
